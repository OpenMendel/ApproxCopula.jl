---
title: "mixedtypes"
author: "sarah"
date: "1/5/2022"
output: html_document
---

https://link.springer.com/content/pdf/10.1080/15598608.2016.1278059.pdf

```{r}
library(survey)
api = data("api", package = "survey")

```

 In this data set,
the Academic Performance Index (API) is computed for all California schools based on
standardized testing of students. 

We use a subset of this data by only considering three
variables, including percent of parents with college degree (colgrad), API tested in 2000
(api00), and API tested in 1999 (api99). For illustration, we consider the scores obtained in
api00 higher than the sample mean 645 as high, otherwise low. Similarly, the scores obtained
in api99 higher than 610 are considered high. T

```{r}
dat = apiclus1[, c(12, 13, 31)]
dat$subject = c(1:183)
dat$binary00 = as.numeric(dat$api00 > 645)
dat$binary99 = as.numeric(dat$api99 > 610)
```


# GLM analysis separately for each binary outcome
```{r}
glm00 <- glm(binary00 ~ 1 + col.grad, 
          family = binomial,
          data   = dat)

glm99 <-  glm(binary99 ~ 1 + col.grad, 
          family = binomial,
          data   = dat)

```

```{r}
glm00
```

```{r}
glm99
```

```{r}
# install.packages("mvProbit")
library(mvProbit)

estResult <- mvProbit(cbind(binary00, binary99) ~ 1 + col.grad,
   data = dat, iterlim = 1, nGHK = 50 )
summary(estResult)
```

# make long format
```{r}
library(tidyr)
data_long <- gather(dat, year, score, binary99:binary00, factor_key=TRUE)
data_long

data_long <- data_long[order(data_long$subject, data_long$year), ]

```

